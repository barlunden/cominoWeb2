---
// src/components/ContactModal.astro
---

<dialog
  id="contact-dialog"
  class="fixed m-auto inset-0 rounded-[2.5rem] bg-white dark:bg-slate-900 p-0 shadow-2xl backdrop:backdrop-blur-sm backdrop:bg-slate-900/50 w-full max-w-2xl border border-slate-100 dark:border-slate-800 transition-all duration-300 opacity-0 scale-95 open:opacity-100 open:scale-100"
>
  <div class="p-8 md:p-12">
    <div class="flex justify-between items-center mb-8">
      <h2 class="text-3xl font-bold text-slate-900 dark:text-white">
        La oss <span class="text-primary italic">prate</span>.
      </h2>
      <button 
        id="close-dialog" 
        class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-500"
        aria-label="Lukk"
      >
        <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>

    <form class="space-y-6">
      <div class="space-y-2">
        <label for="modal-name" class="text-sm font-bold text-slate-700 dark:text-slate-300 ml-1">Navn</label>
        <input type="text" id="modal-name" class="w-full px-6 py-4 rounded-2xl border-none bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary transition-all outline-none" placeholder="Ditt navn" />
      </div>

      <div class="space-y-2">
        <label for="modal-email" class="text-sm font-bold text-slate-700 dark:text-slate-300 ml-1">E-post</label>
        <input type="email" id="modal-email" class="w-full px-6 py-4 rounded-2xl border-none bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary transition-all outline-none" placeholder="din@epost.no" />
      </div>

      <div class="space-y-2">
        <label for="modal-message" class="text-sm font-bold text-slate-700 dark:text-slate-300 ml-1">Melding</label>
        <textarea id="modal-message" rows="4" class="w-full px-6 py-4 rounded-2xl border-none bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary transition-all outline-none" placeholder="Hva kan vi hjelpe deg med?"></textarea>
      </div>

      <button type="submit" class="w-full py-5 bg-primary text-white font-bold rounded-2xl hover:scale-[1.02] active:scale-[0.98] transition-all shadow-lg shadow-primary/25">
        Send melding
      </button>
    </form>
  </div>
</dialog>

<style>
  /* Handle the animation for the backdrop separately */
  dialog::backdrop {
    transition: opacity 0.3s ease-out;
  }
  
  dialog:not([open]) {
    pointer-events: none;
    display: none;
  }
</style>

<script>
  const dialog = document.getElementById('contact-dialog') as HTMLDialogElement;
  const closeBtn = document.getElementById('close-dialog');
  const openBtns = document.querySelectorAll('.open-contact');

  // Open logic
  openBtns.forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      dialog.showModal();
    });
  });

  // Close logic
  closeBtn?.addEventListener('click', () => dialog.close());

  // Close on click outside (on backdrop)
  dialog.addEventListener('click', (e) => {
    if (e.target === dialog) dialog.close();
  });
</script>