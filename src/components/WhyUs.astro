---
import { getCollection } from 'astro:content';

// Hent alle features
const features = await getCollection('features');

// Sorter og render innhald (Content) for kvar feature
const sortedFeatures = await Promise.all(
  features
    .sort((a, b) => a.data.order - b.data.order)
    .map(async (feature) => {
      const { Content } = await feature.render();
      return { ...feature, Content };
    })
);
---

<section class="py-24 bg-primary dark:bg-page-dark text-white overflow-hidden transition-colors duration-500 relative">
  
  <div class="absolute inset-0 dark:bg-[radial-gradient(circle_at_30%_30%,rgba(0,125,210,0.1),transparent)] pointer-events-none"></div>

  <div class="container mx-auto px-6 relative z-10">
    <div class="grid lg:grid-cols-2 gap-20 items-center">
      <div>
        <h2 class="text-4xl md:text-5xl font-bold mb-8 tracking-tight italic text-white">
          Hvorfor velge <span class="text-blue-200 dark:text-primary-light">Comino Web?</span>
        </h2>
        <p class="text-blue-100/90 dark:text-slate-400 text-lg max-w-xl leading-relaxed transition-colors">
          Vi bygger ikke nettsider på samlebånd. Vi bruker moderne verktøy og 
          stødig håndverk for å lage løsninger som er raske, trygge og enkle å eie.
        </p>
      </div>
      
      <div class="grid gap-12">
        {sortedFeatures.map(({ data, Content }) => (
          <div class="flex gap-6 group cursor-default">
            <div class="w-14 h-14 shrink-0 bg-white/10 dark:bg-slate-800/50 rounded-2xl flex items-center justify-center border border-white/20 dark:border-slate-700/50 group-hover:bg-blue-400/20 group-hover:border-primary-light/50 transition-all duration-500 shadow-lg shadow-black/5">
               {data.iconName === 'lightning' && (
                 <svg class="w-7 h-7 text-blue-200 dark:text-primary-light" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                 </svg>
               )}
               {data.iconName === 'scaling' && (
                 <svg class="w-7 h-7 text-blue-200 dark:text-primary-light" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                 </svg>
               )}
            </div>

            <div class="flex-1">
              <h3 class="text-2xl font-bold mb-2 group-hover:text-blue-200 dark:group-hover:text-primary-light transition-colors duration-300 text-white">
                {data.title}
              </h3>
              
              <p class="text-blue-100/70 dark:text-slate-400 leading-relaxed text-lg transition-colors">
                {data.description}
              </p>

              <div class="max-h-0 opacity-0 overflow-hidden group-hover:max-h-64 group-hover:opacity-100 transition-all duration-700 ease-in-out">
                <div class="pt-4 text-blue-200/50 dark:text-slate-500 prose prose-sm prose-invert leading-relaxed border-l-2 border-blue-400/30 dark:border-primary-light/20 pl-4 mt-2">
                  <Content />
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>