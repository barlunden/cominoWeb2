---
// src/components/ThemeToggle.astro
---

<button
  id="themeToggle"
  class="relative inline-flex h-8 w-14 shrink-0 cursor-pointer items-center rounded-full bg-slate-200 dark:bg-slate-800 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-slate-950"
  role="switch"
  aria-label="Bytt mellom lyst og m√∏rkt tema"
>
  <span class="absolute left-1.5 z-10 text-[10px] pointer-events-none dark:opacity-0 transition-opacity duration-300">‚òÄÔ∏è</span>
  
  <span class="absolute right-1.5 z-10 text-[10px] pointer-events-none opacity-0 dark:opacity-100 transition-opacity duration-300">üåô</span>

  <span
  class="pointer-events-none inline-block h-6 w-6 transform rounded-full bg-white shadow-md transition duration-300 ease-in-out translate-x-1 [.dark_&]:translate-x-7"
></span>
</button>

<script>
  // Vi pakker alt inn i en funksjon
  function setupThemeToggle() {
    const btn = document.getElementById('themeToggle');
    
    if (btn) {
      btn.addEventListener('click', () => {
        // 1. Toggle klassen p√• <html>
        document.documentElement.classList.toggle('dark');
        
        // 2. Lagre valget i localStorage
        const isDark = document.documentElement.classList.contains('dark');
        localStorage.setItem('theme', isDark ? 'dark' : 'light');
      });
    }
  }

  // Kj√∏r funksjonen med en gang scriptet lastes
  setupThemeToggle();

  // VIKTIG: Hvis du bruker Astro View Transitions, m√• den ogs√• kj√∏re etter sidebytte
  document.addEventListener('astro:after-swap', setupThemeToggle);
</script>