---
// Navigasjonsheader for alle sider
const currentPath = Astro.url.pathname;
---

<header class="fixed top-0 w-full bg-white/95 backdrop-blur-sm shadow-sm z-50">
  <nav class="container mx-auto px-6 py-4">
    <div class="flex items-center justify-between">
      <a
        href="/"
        class="flex items-center hover:opacity-80 transition-opacity"
        id="home"
      >
        <img src="/LogoComino.png" alt="Comino Web" class="h-10" />
      </a>
      <!-- Hamburgermeny -->
      <button
        class="hamburger md:hidden"
        aria-label="Ã…pne meny"
        aria-expanded="false"
        id="hamburger-btn"
        type="button"
      >
        <span class="block w-8 h-1 bg-blue-800 mb-1"></span>
        <span class="block w-8 h-1 bg-blue-800 mb-1"></span>
        <span class="block w-8 h-1 bg-blue-800"></span>
      </button>

      <!-- Mobilmeny -->
      <ul class="dropdown-menu mobile-menu bg-blue-900 text-lg" id="mobilmeny-menu">
        <button
          class="mobile-menu-exit"
          aria-label="Lukk meny"
          type="button"
          id="mobilmeny-exit-btn">&times;</button
        >
        <li>
          <a
            href="/artikler"
            class:list={[
              "hover:text-blue-400 p-4 transition-colors",
              currentPath.startsWith("/artikler")
                ? "text-blue-400 p-4 font-semibold"
                : "text-gray-300 p-4 font-semibold",
            ]}
          >
            Artikler
          </a>
        </li>
        <li>
          <a
            href="/tjenester"
            class:list={[
              "hover:text-blue-400 p-4 transition-colors",
              currentPath === "/tjenester"
                ? "text-blue-400 p-4 font-semibold"
                : "text-gray-300 p-4 font-semibold",
            ]}
          >
            Tjenester
          </a>
        </li>
        <li>
          <a
            href="/prosjekt"
            class:list={[
              "hover:text-blue-400 p-4 transition-colors",
              currentPath === "/prosjekt"
                ? "text-blue-400 p-4 font-semibold"
                : "text-gray-300 p-4 font-semibold",
            ]}
          >
            Prosjekter
          </a>
        </li>
        <li>
          <a
            href="/om-oss"
            class:list={[
              "hover:text-blue-400 p-4 transition-colors",
              currentPath === "/om-oss"
                ? "text-blue-400 p-4 font-semibold"
                : "text-gray-300 p-4 font-semibold",
            ]}
          >
            Om oss
          </a>
        </li>
        <li>
          <a
            href="/kontakt"
            class:list={[
              "hover:text-blue-400 p-4 transition-colors",
              currentPath === "/om-oss"
                ? "text-blue-400 p-4 font-semibold"
                : "text-gray-300 p-4 font-semibold",
            ]}
          >
            Kontakt
          </a>
        </li>
      </ul>


      <!-- Desktopmeny -->
      <ul class="hidden md:flex space-x-8">
        <li>
          <a
            href="/artikler"
            class:list={[
              "hover:text-blue-600 transition-colors",
              currentPath.startsWith("/artikler")
                ? "text-blue-600 font-semibold"
                : "text-gray-700 font-semibold",
            ]}
          >
            Artikler
          </a>
        </li>
        <li>
          <a
            href="/tjenester"
            class:list={[
              "hover:text-blue-600 transition-colors",
              currentPath === "/tjenester"
                ? "text-blue-600 font-semibold"
                : "text-gray-700 font-semibold",
            ]}
          >
            Tjenester
          </a>
        </li>
        <li>
          <a
            href="/prosjekt"
            class:list={[
              "hover:text-blue-600 transition-colors",
              currentPath === "/prosjekt"
                ? "text-blue-600 font-semibold"
                : "text-gray-700 font-semibold",
            ]}
          >
            Prosjekter
          </a>
        </li>
        <li>
          <a
            href="/om-oss"
            class:list={[
              "hover:text-blue-600 transition-colors",
              currentPath === "/om-oss"
                ? "text-blue-600 font-semibold"
                : "text-gray-700 font-semibold",
            ]}
          >
            Om oss
          </a>
        </li>
        <li>
          <a
            href="/kontakt"
            class="bg-blue-800 text-white px-4 py-2 rounded-xl font-semibold hover:bg-blue-900 transition-colors"
          >
            Kontakt
          </a>
        </li>
      </ul>

      
    </div>
  </nav>
</header>

<!-- Spacer for fixed header -->
<div class="h-20"></div>

<script type="module" is:inline>
  // Desktop dropdowns
  /* const dropdowns = [
      { btn: "tjenester-btn", menu: "tjenester-menu" },
      { btn: "prosjekter-btn", menu: "prosjekter-menu" },
    ];

    dropdowns.forEach(({ btn, menu }) => {
      const button = document.getElementById(btn);
      const menuEl = document.getElementById(menu);
      if (button && menuEl) {
        function closeDropdown() {
          menuEl.classList.remove("open");
          button.setAttribute("aria-expanded", "false");
          button.classList.remove("dropdown-open");
        }
        button.addEventListener("click", (e) => {
          e.stopPropagation();
          const isOpen = menuEl.classList.toggle("open");
          button.setAttribute("aria-expanded", isOpen ? "true" : "false");
          button.classList.toggle("dropdown-open", isOpen);
        });
        document.addEventListener("click", (e) => {
          if (!button.parentElement.contains(e.target)) closeDropdown();
        });
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") closeDropdown();
        });
      }
    }); */

  // Hamburgermeny
  const hamburgerBtn = document.getElementById("hamburger-btn");
  const mobilMenu = document.getElementById("mobilmeny-menu");
  // Legg til exit-knapp
  const mobilMenuExitBtn = document.getElementById("mobilmeny-exit-btn");
  if (hamburgerBtn && mobilMenu) {
    function closeMobilDropdown() {
      mobilMenu.classList.remove("open");
      hamburgerBtn.setAttribute("aria-expanded", "false");
      hamburgerBtn.classList.remove("dropdown-open");
    }
    hamburgerBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      const isOpen = mobilMenu.classList.toggle("open");
      hamburgerBtn.setAttribute("aria-expanded", isOpen ? "true" : "false");
      hamburgerBtn.classList.toggle("dropdown-open", isOpen);
    });
    document.addEventListener("click", (e) => {
      if (!hamburgerBtn.parentElement.contains(e.target)) closeMobilDropdown();
    });
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeMobilDropdown();
    });
    mobilMenu.querySelectorAll("a").forEach((link) => {
      link.addEventListener("click", () => {
        closeMobilDropdown();
      });
    });
    // Exit-knapp funksjonalitet
    if (mobilMenuExitBtn) {
      mobilMenuExitBtn.addEventListener("click", () => {
        closeMobilDropdown();
      });
    }
  }
</script>

<style>
  .hamburger {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    display: none;
  }
  @media (max-width: 845px) {
    .hamburger {
      display: block;
      margin-left: auto;
    }
    .mobile-menu {
      display: none;
    }
    .mobile-menu.open {
      display: block;
    }
  }
  .dropdown-menu {
    display: none;
    position: absolute;
    top: 110%;
    left: 0;
    min-width: 220px;
    z-index: 100;
    box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.08);
    padding: 0.5rem 0;
  }
  .dropdown-menu.open {
    display: block;
    animation: fadeIn 0.2s;
  }
  .dropdown-menu li {
    margin: 0;
  }
  @media (max-width: 845px) {
    .dropdown-menu {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      min-width: 0;
      box-shadow: none;
      border: none;
      padding: 2rem 0 1rem 0;
      z-index: 9999;
    }
  }
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .mobile-menu-exit {
    display: none;
  }
  @media (max-width: 845px) {
    .mobile-menu-exit {
      display: block;
      position: absolute;
      top: 1rem;
      right: 1.5rem;
      background: none;
      border: none;
      color: hsl(240, 5%, 90%);
      font-size: 2.2rem;
      font-weight: bold;
      cursor: pointer;
      z-index: 10001;
      padding: 0;
      line-height: 1;
    }
  }
</style>
