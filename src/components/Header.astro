---
import Logo from "./Logo.astro";
import ThemeToggle from "./ThemeToggle.astro";

// Navigasjonsheader for Comino Web v2
const currentPath = Astro.url.pathname;

const navLinks = [
  { name: 'Artikler', href: '/artikler' },
  { name: 'Tjenester', href: '/tjenester' },
  { name: 'Prosjekter', href: '/prosjekt' },
  { name: 'Om oss', href: '/om-oss' },
];

const isActive = (path: string) => 
  path === '/' ? currentPath === '/' : currentPath.startsWith(path);
---

<header class="fixed top-0 w-full bg-white/95 backdrop-blur-md shadow-sm z-100 border-b border-slate-100">
  <nav class="container mx-auto px-6 h-20 flex items-center justify-between">
    
    <!-- <a href="/" class="flex items-center shrink-0 relative z-120">
       <img src="/LogoComino.png" alt="Comino Web" class="h-10 w-auto object-contain" />
    </a> -->
    <Logo />

    <button
      class="group md:hidden w-12 h-12 flex items-center justify-center relative z-120 cursor-pointer"
      aria-label="Meny"
      id="hamburger-btn"
    >
      <div class="relative w-8 h-5">
        <span id="line-1" class="absolute block w-8 h-0.5 bg-primary transition-all duration-300 top-0"></span>
        <span id="line-2" class="absolute block w-8 h-0.5 bg-primary transition-all duration-300 top-2"></span>
        <span id="line-3" class="absolute block w-8 h-0.5 bg-primary transition-all duration-300 top-4"></span>
      </div>
    </button>

    <ul class="hidden md:flex items-center space-x-8">
      {navLinks.map(link => (
        <li>
          <a href={link.href} class:list={["transition-colors font-semibold", isActive(link.href) ? "text-primary" : "text-slate-600 hover:text-primary"]}>
            {link.name}
          </a>
        </li>
      ))}
      <li>
        <a href="/kontakt" class="bg-primary text-white px-5 py-2.5 rounded-xl font-semibold hover:bg-primary-hover transition-all shadow-sm">
          Kontakt
        </a>
      </li>
    </ul>
    
  </nav>

  <div 
    id="mobilmeny-menu" 
    class="hidden fixed inset-0 bg-white z-110 flex-col p-6 h-screen w-screen overflow-y-auto pt-28"
  >
    <nav class="flex flex-col space-y-6">
      {navLinks.map(link => (
        <a
          href={link.href}
          class:list={[
            "text-2xl font-bold border-b border-slate-100 pb-4",
            isActive(link.href) ? "text-primary border-primary" : "text-slate-600"
          ]}
        >
          {link.name}
        </a>
      ))}
      <a 
        href="/kontakt" 
        class="bg-primary text-white text-center px-8 py-4 rounded-xl font-bold text-xl mt-4 shadow-lg"
      >
        Kontakt oss
      </a>
    </nav>
  </div>
</header>

<script is:inline>
  // Vi bruker en enkel funksjon for å styre alt
  const setupNavbar = () => {
    const btn = document.getElementById("hamburger-btn");
    const menu = document.getElementById("mobilmeny-menu");
    const l1 = document.getElementById("line-1");
    const l2 = document.getElementById("line-2");
    const l3 = document.getElementById("line-3");

    if (!btn || !menu) return;

    btn.addEventListener("click", () => {
      const isOpen = menu.classList.contains('flex');
      
      if (!isOpen) {
        // Åpne
        menu.classList.remove('hidden');
        menu.classList.add('flex');
        document.body.style.overflow = 'hidden';
        
        // Animasjon til X
        l1.style.transform = "translateY(8px) rotate(45deg)";
        l2.style.opacity = "0";
        l3.style.transform = "translateY(-8px) rotate(-45deg)";
      } else {
        // Lukk
        menu.classList.add('hidden');
        menu.classList.remove('flex');
        document.body.style.overflow = '';
        
        // Tilbake til hamburger
        l1.style.transform = "translateY(0) rotate(0)";
        l2.style.opacity = "1";
        l3.style.transform = "translateY(0) rotate(0)";
      }
    });

    // Lukk menyen når man klikker på en lenke
    menu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        menu.classList.add('hidden');
        menu.classList.remove('flex');
        document.body.style.overflow = '';
        l1.style.transform = "translateY(0) rotate(0)";
        l2.style.opacity = "1";
        l3.style.transform = "translateY(0) rotate(0)";
      });
    });
  };

  // Kjør oppsettet
  setupNavbar();
</script>